<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Delgado">
<meta name="dcterms.date" content="2024-03-26">
<meta name="description" content="Training data to predict if a person will default on a loan by finding a threshold using a LogisticRegression model!">

<title>Daniela’s CSCI 0451 Blog - Optimal Decision Making</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background-image: url(../../img/landscape.png);
background-size: cover;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Daniela’s CSCI 0451 Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Optimal Decision Making</h1>
                  <div>
        <div class="description">
          Training data to predict if a person will default on a loan by finding a threshold using a LogisticRegression model!
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Daniela Delgado </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 26, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1">
<h1><strong>Introduction</strong></h1>
<ul>
<li><p>In this blog post, I start off by making different graphs and tables to see if there is any correlation and patterns between a person’s information and seeing how the interest rate is affected by this information. Then, I used logistic regression to construct a score function and threshold for predicting whether a prospective borrower is likely to default on a given loan. Looping through the max and min scores, I found the best threshold to maximize the bank’s profit by calculating how much the bank will gain or lose based on if the person with that score defaults or not from paying the loan. In my test results, I got that the best threshold was about -0.175 with the bank’s expected profit per borrower to be about $1168.39.</p></li>
<li><p>In seeing if certain groups have more difficulty than others in getting a loan because of defaulting based on the threshold proposed from the system, all of the borrowers have a decision, or probability, of defaulting based on the threshold. There might be an error or missing step in my calculations.</p></li>
</ul>
</section>
<section id="part-a-grab-the-data" class="level1">
<h1>Part A: Grab the Data</h1>
<div id="cell-3" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># downloading training data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/train.csv"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.read_csv(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="204">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">person_age</th>
<th data-quarto-table-cell-role="th">person_income</th>
<th data-quarto-table-cell-role="th">person_home_ownership</th>
<th data-quarto-table-cell-role="th">person_emp_length</th>
<th data-quarto-table-cell-role="th">loan_intent</th>
<th data-quarto-table-cell-role="th">loan_grade</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_status</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file</th>
<th data-quarto-table-cell-role="th">cb_person_cred_hist_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>43200</td>
<td>RENT</td>
<td>NaN</td>
<td>VENTURE</td>
<td>B</td>
<td>1200</td>
<td>9.91</td>
<td>0</td>
<td>0.03</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>27</td>
<td>98000</td>
<td>RENT</td>
<td>3.0</td>
<td>EDUCATION</td>
<td>C</td>
<td>11750</td>
<td>13.47</td>
<td>0</td>
<td>0.12</td>
<td>Y</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22</td>
<td>36996</td>
<td>RENT</td>
<td>5.0</td>
<td>EDUCATION</td>
<td>A</td>
<td>10000</td>
<td>7.51</td>
<td>0</td>
<td>0.27</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>24</td>
<td>26000</td>
<td>RENT</td>
<td>2.0</td>
<td>MEDICAL</td>
<td>C</td>
<td>1325</td>
<td>12.87</td>
<td>1</td>
<td>0.05</td>
<td>N</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>29</td>
<td>53004</td>
<td>MORTGAGE</td>
<td>2.0</td>
<td>HOMEIMPROVEMENT</td>
<td>A</td>
<td>15000</td>
<td>9.63</td>
<td>0</td>
<td>0.28</td>
<td>N</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="part-b-explore-the-data" class="level1">
<h1>Part B: Explore The Data</h1>
<div id="cell-6" class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> df_train, x <span class="op">=</span> <span class="st">'loan_int_rate'</span>, y <span class="op">=</span> <span class="st">'loan_percent_income'</span>, hue <span class="op">=</span> <span class="st">'cb_person_default_on_file'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Loan interest rate and loan percent income based on person defaulting"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In this scatterplot, we can see the how the loan interest rate is affected by seeing if the person defaulted previously on a loan and the person’s percent income. The loan interest rate increases if the person has a record of defaulting on a loan.</p>
<div id="cell-8" class="cell" data-execution_count="206">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data <span class="op">=</span> df_train, x <span class="op">=</span> <span class="st">'person_home_ownership'</span>, y <span class="op">=</span> <span class="st">'loan_int_rate'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Interest Rate Based on a Person's Home Ownership"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This graph further explores how the loan interest rate differs and compares based on a person’s home ownership. We can see that a person who has a mortgage has a lower mean for the interest rate, while a person renting and those with other forms of home ownership have higher loan interest rates on average.</p>
<div id="cell-10" class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>meanTable <span class="op">=</span> df_train.groupby([<span class="st">'loan_intent'</span>, <span class="st">'cb_person_default_on_file'</span>]).aggregate({<span class="st">'person_age'</span>: [<span class="st">'mean'</span>, <span class="st">'std'</span>], <span class="st">'person_income'</span> : [<span class="st">'mean'</span>, <span class="st">'std'</span>], <span class="st">'cb_person_cred_hist_length'</span> : [<span class="st">'mean'</span>, <span class="st">'std'</span>], <span class="st">'loan_int_rate'</span>: [<span class="st">'mean'</span>, <span class="st">'std'</span>]})</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>meanTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="207">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">person_age</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">person_income</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">cb_person_cred_hist_length</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">loan_int_rate</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">loan_intent</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">DEBTCONSOLIDATION</td>
<td data-quarto-table-cell-role="th">N</td>
<td>27.523949</td>
<td>5.822429</td>
<td>66504.540596</td>
<td>54849.658619</td>
<td>5.644276</td>
<td>3.915509</td>
<td>10.216206</td>
<td>3.008325</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>27.883289</td>
<td>6.379513</td>
<td>67551.327586</td>
<td>58425.810386</td>
<td>5.928382</td>
<td>4.121033</td>
<td>14.565023</td>
<td>1.758878</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">EDUCATION</td>
<td data-quarto-table-cell-role="th">N</td>
<td>26.505755</td>
<td>6.058923</td>
<td>64403.688983</td>
<td>40406.252292</td>
<td>5.074231</td>
<td>3.572837</td>
<td>10.273948</td>
<td>2.967930</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>27.047126</td>
<td>6.009493</td>
<td>61127.258621</td>
<td>35589.171553</td>
<td>5.471264</td>
<td>3.910798</td>
<td>14.357234</td>
<td>1.650609</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">HOMEIMPROVEMENT</td>
<td data-quarto-table-cell-role="th">N</td>
<td>29.088624</td>
<td>5.637893</td>
<td>72891.920750</td>
<td>49281.092741</td>
<td>6.512995</td>
<td>3.964697</td>
<td>10.358453</td>
<td>3.158075</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>28.529730</td>
<td>5.966250</td>
<td>73886.228829</td>
<td>52241.077202</td>
<td>6.079279</td>
<td>3.974765</td>
<td>14.576099</td>
<td>1.739466</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">MEDICAL</td>
<td data-quarto-table-cell-role="th">N</td>
<td>27.927044</td>
<td>6.376993</td>
<td>61528.271447</td>
<td>48179.985735</td>
<td>5.912201</td>
<td>4.004978</td>
<td>10.281730</td>
<td>2.989114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>28.061628</td>
<td>6.322874</td>
<td>60326.900000</td>
<td>59500.584963</td>
<td>5.919767</td>
<td>4.109030</td>
<td>14.531599</td>
<td>1.718297</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">PERSONAL</td>
<td data-quarto-table-cell-role="th">N</td>
<td>28.361028</td>
<td>7.562245</td>
<td>68244.272206</td>
<td>113892.066168</td>
<td>6.190763</td>
<td>4.709577</td>
<td>10.280876</td>
<td>2.981917</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>27.933244</td>
<td>6.696901</td>
<td>67221.606142</td>
<td>57537.660727</td>
<td>5.958611</td>
<td>4.295520</td>
<td>14.536935</td>
<td>1.737584</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">VENTURE</td>
<td data-quarto-table-cell-role="th">N</td>
<td>27.589281</td>
<td>6.216285</td>
<td>65544.232157</td>
<td>46928.520701</td>
<td>5.745882</td>
<td>3.957178</td>
<td>10.189561</td>
<td>2.935957</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Y</td>
<td>27.585551</td>
<td>5.808216</td>
<td>68787.400507</td>
<td>82746.627032</td>
<td>5.735108</td>
<td>4.021774</td>
<td>14.544407</td>
<td>1.740218</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In this table, part of the data is summarized by finding the mean and the standard deviation of a person’s age, their income, their credit history length, and their given loan interest rate based on their loan intent and whether or not they defaulted previously on a loan. This table is helpful as we can see what factors play into having a higher interest rate, and we can see how age, income, or their credit history length varies based on defaulting on a loan and their loan intent. The standard deviation is important to see how much of the data falls into or out of the calculated mean.</p>
</section>
<section id="part-c-building-a-model" class="level1">
<h1>Part C: Building a Model:</h1>
<p>Construct a score function and threshold for predicting whether a prospective borrower is likely to default on a given loan. You may use all the features in the data except loan_grade and the target variable loan_status.</p>
<div id="cell-13" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>le.fit(df_train[<span class="st">"loan_status"</span>]) <span class="co">#fit encoder on 'loan_status'</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prepare_data(df):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#removing columns that are not needed</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.drop([<span class="st">"loan_grade"</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#removing N/A labels</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.dropna()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(df)</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#turns the labels in 'loan_status' to a number</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> le.transform(df[<span class="st">"loan_status"</span>])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print(y)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#removing 'loan_status' col bc now held by y</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df.drop([<span class="st">"loan_status"</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#converted into “one-hot encoded” 0-1 columns</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.get_dummies(df)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df, y</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>X_train, y_train <span class="op">=</span> prepare_data(df_train)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-14" class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>y_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<pre><code>array([0, 0, 1, ..., 0, 0, 1])</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> combinations</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score <span class="co">#use this isntead of for-loop</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>quant_cols <span class="op">=</span> [<span class="st">'person_income'</span>, <span class="st">'loan_amnt'</span>, <span class="st">'loan_int_rate'</span>]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>score_counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>LR <span class="op">=</span> LogisticRegression()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#using cross validation on LR to avoid overfitting</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>cv_scores_LR <span class="op">=</span> cross_val_score(LR, X_train[quant_cols], y_train, cv <span class="op">=</span> <span class="dv">5</span>) <span class="co">#training on remaining 80% of data</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> cv_scores_LR.mean() <span class="op">&gt;</span> score_counter:</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="co">#updating the best score and columns of that score</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      score_counter <span class="op">=</span> cv_scores_LR.mean()</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Best Score: '</span>, score_counter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Score:  0.8117172718507574</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="308">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">person_age</th>
<th data-quarto-table-cell-role="th">person_income</th>
<th data-quarto-table-cell-role="th">person_emp_length</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
<th data-quarto-table-cell-role="th">loan_percent_income</th>
<th data-quarto-table-cell-role="th">cb_person_cred_hist_length</th>
<th data-quarto-table-cell-role="th">person_home_ownership_MORTGAGE</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OTHER</th>
<th data-quarto-table-cell-role="th">person_home_ownership_OWN</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">loan_intent_HOMEIMPROVEMENT</th>
<th data-quarto-table-cell-role="th">loan_intent_MEDICAL</th>
<th data-quarto-table-cell-role="th">loan_intent_PERSONAL</th>
<th data-quarto-table-cell-role="th">loan_intent_VENTURE</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file_N</th>
<th data-quarto-table-cell-role="th">cb_person_default_on_file_Y</th>
<th data-quarto-table-cell-role="th">paid_gain</th>
<th data-quarto-table-cell-role="th">default_loss</th>
<th data-quarto-table-cell-role="th">Scores</th>
<th data-quarto-table-cell-role="th">decision</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>27</td>
<td>98000</td>
<td>3.0</td>
<td>11750</td>
<td>13.47</td>
<td>0.12</td>
<td>6</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>4613.567568</td>
<td>-6997.533847</td>
<td>-2.724145</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>22</td>
<td>36996</td>
<td>5.0</td>
<td>10000</td>
<td>7.51</td>
<td>0.27</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>2044.334031</td>
<td>-6426.108799</td>
<td>-0.435472</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>24</td>
<td>26000</td>
<td>2.0</td>
<td>1325</td>
<td>12.87</td>
<td>0.05</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>493.650464</td>
<td>-795.445199</td>
<td>-0.913722</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>29</td>
<td>53004</td>
<td>2.0</td>
<td>15000</td>
<td>9.63</td>
<td>0.28</td>
<td>10</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>4028.690420</td>
<td>-9390.333437</td>
<td>-0.552180</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>21</td>
<td>21700</td>
<td>2.0</td>
<td>5500</td>
<td>14.91</td>
<td>0.25</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>2430.522429</td>
<td>-3211.752128</td>
<td>-0.294372</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26059</td>
<td>36</td>
<td>150000</td>
<td>8.0</td>
<td>3000</td>
<td>7.29</td>
<td>0.02</td>
<td>17</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>593.840622</td>
<td>-1932.967484</td>
<td>-5.766362</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26060</td>
<td>23</td>
<td>48000</td>
<td>1.0</td>
<td>4325</td>
<td>5.42</td>
<td>0.09</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>623.093432</td>
<td>-2849.295748</td>
<td>-1.486665</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26061</td>
<td>22</td>
<td>60000</td>
<td>0.0</td>
<td>15000</td>
<td>11.71</td>
<td>0.25</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>5017.300210</td>
<td>-9143.682505</td>
<td>-0.836032</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26062</td>
<td>30</td>
<td>144000</td>
<td>12.0</td>
<td>35000</td>
<td>12.68</td>
<td>0.24</td>
<td>8</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>12819.204794</td>
<td>-21064.871625</td>
<td>-2.113038</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26063</td>
<td>25</td>
<td>60000</td>
<td>5.0</td>
<td>21450</td>
<td>7.29</td>
<td>0.36</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>4245.960448</td>
<td>-13820.717511</td>
<td>-0.148728</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>22907 rows × 23 columns</p>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>y_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">
<pre><code>array([0, 0, 1, ..., 0, 0, 1])</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>LR.fit(X_train[quant_cols], y_train)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> LR.coef_</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>LR.score(X_train[quant_cols], y_train)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="239">
<pre><code>0.8080062862880342</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="240">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="240">
<pre><code>array([[-4.05735976e-05,  1.06558819e-04,  9.49045880e-08]])</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="313">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the scores</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> X_train[quant_cols]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">person_income</th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">loan_int_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>98000</td>
<td>11750</td>
<td>13.47</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>36996</td>
<td>10000</td>
<td>7.51</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>26000</td>
<td>1325</td>
<td>12.87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>53004</td>
<td>15000</td>
<td>9.63</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>21700</td>
<td>5500</td>
<td>14.91</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26059</td>
<td>150000</td>
<td>3000</td>
<td>7.29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26060</td>
<td>48000</td>
<td>4325</td>
<td>5.42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26061</td>
<td>60000</td>
<td>15000</td>
<td>11.71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26062</td>
<td>144000</td>
<td>35000</td>
<td>12.68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26063</td>
<td>60000</td>
<td>21450</td>
<td>7.29</td>
</tr>
</tbody>
</table>

<p>22907 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> x<span class="op">@</span>w.T</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="244">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>-2.724145</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.435472</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.913722</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.552180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.294372</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26059</td>
<td>-5.766362</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26060</td>
<td>-1.486665</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26061</td>
<td>-0.836032</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26062</td>
<td>-2.113038</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26063</td>
<td>-0.148728</td>
</tr>
</tbody>
</table>

<p>22907 rows × 1 columns</p>
</div>
</div>
</div>
</section>
<section id="part-d-finding-a-threshold" class="level1">
<h1>Part D: Finding a Threshold</h1>
<p>Find a threshold that maximizes the bank’s profit.</p>
<div id="cell-23" class="cell" data-execution_count="316">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate paid gain and loss here and add these array values in the columns of the table</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vectorization</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>int_rate_decimal <span class="op">=</span> np.divide(X_train[<span class="st">'loan_int_rate'</span>], <span class="dv">100</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'paid_gain'</span>] <span class="op">=</span> X_train[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> int_rate_decimal)<span class="op">**</span><span class="dv">10</span> <span class="op">-</span> X_train[<span class="st">'loan_amnt'</span>]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'default_loss'</span>] <span class="op">=</span> X_train[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> int_rate_decimal)<span class="op">**</span> <span class="op">-</span> <span class="fl">1.7</span> <span class="op">*</span> X_train[<span class="st">'loan_amnt'</span>]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'Scores'</span>] <span class="op">=</span> scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'Scores'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="317">
<pre><code>1       -2.724145
2       -0.435472
3       -0.913722
4       -0.552180
6       -0.294372
           ...   
26059   -5.766362
26060   -1.486665
26061   -0.836032
26062   -2.113038
26063   -0.148728
Name: Scores, Length: 22907, dtype: float64</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>all_total_profit <span class="op">=</span> []</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>best_profit <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>total_t_profit <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> threshold <span class="kw">in</span> np.linspace(scores.<span class="bu">min</span>(), scores.<span class="bu">max</span>(), <span class="dv">100</span>): <span class="co">#np.linspace(scores.min(), scores.max(), 100)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#new col in for loop that makes the decision "decision col" checks if score is larger than threshold</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    X_train[<span class="st">'decision'</span>] <span class="op">=</span> X_train[<span class="st">'Scores'</span>] <span class="op">&gt;=</span> threshold[<span class="dv">0</span>] <span class="co">#returns bool threshold[0] with np.linspace</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    t_profit <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> X_train[<span class="st">'decision'</span>]) <span class="op">*</span> (X_train[<span class="st">'paid_gain'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y_train) <span class="op">+</span> X_train[<span class="st">'default_loss'</span>] <span class="op">*</span> (y_train))</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t_profit = (1-threshold) * (X_train['paid_gain'] + threshold * X_train['default_loss'])</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{X_train['paid_gain']= }")</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(f"{X_train['default_loss']= }")</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#calculating mean profit</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    all_total_profit.append(t_profit.mean())</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#return highest threshold based on highest gain</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t_profit.mean() <span class="op">&gt;</span> best_profit:</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        best_profit <span class="op">=</span> t_profit.mean()</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        best_t <span class="op">=</span> threshold[<span class="dv">0</span>] <span class="co">#threshold[0] with np.linspace</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        profit_per_borrower <span class="op">=</span> t_profit.mean()</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">#find probability and loop through thresholds</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_t_profit)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'highest profit: '</span>, best_profit)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'best threshold that optimizes profit for the bank: '</span>, best_t)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'bank’s expected profit per borrower: '</span>, profit_per_borrower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0
highest profit:  1158.6189787929175
best threshold that optimizes profit for the bank:  -0.9466451695144542
bank’s expected profit per borrower:  1158.6189787929175</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#threshold vs profit (all_total_profit)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(scores.<span class="bu">min</span>(), scores.<span class="bu">max</span>(), <span class="dv">100</span>), all_total_profit)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.gca().<span class="bu">set</span>(xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">7</span>,<span class="va">None</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_t, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, lw <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Threshold"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total Profit"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Threshold vs. Total Profit"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-e-evaluate-your-model-from-the-banks-perspective" class="level1">
<h1>Part E: Evaluate Your Model from the Bank’s Perspective</h1>
<div id="cell-28" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/test.csv"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>X_test, y_test <span class="op">=</span> prepare_data(df_test)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>LR.score(X_test[quant_cols], y_test)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> X_test[quant_cols]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>test_scores <span class="op">=</span> x<span class="op">@</span>w.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finding threshold of testing set:</p>
<div id="cell-30" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate paid gain and loss here and add these array values in the columns of the table</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vectorization</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>int_rate_decimal <span class="op">=</span> np.divide(X_test[<span class="st">'loan_int_rate'</span>], <span class="dv">100</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'paid_gain'</span>] <span class="op">=</span> X_test[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> int_rate_decimal)<span class="op">**</span><span class="dv">10</span> <span class="op">-</span> X_test[<span class="st">'loan_amnt'</span>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'default_loss'</span>] <span class="op">=</span> X_test[<span class="st">'loan_amnt'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> int_rate_decimal)<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> <span class="fl">1.7</span> <span class="op">*</span> X_test[<span class="st">'loan_amnt'</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'Scores'</span>] <span class="op">=</span> test_scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-31" class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>all_total_profit <span class="op">=</span> []</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>best_profit <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>total_t_profit <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> threshold <span class="kw">in</span> np.linspace(test_scores.<span class="bu">min</span>(), test_scores.<span class="bu">max</span>(), <span class="dv">100</span>):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#new col in for loop that makes the decision "decision col" checks if score is larger than threshold</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    X_test[<span class="st">'decision'</span>] <span class="op">=</span> X_test[<span class="st">'Scores'</span>] <span class="op">&gt;</span> threshold[<span class="dv">0</span>] <span class="co">#returns bool threshold[0] with np.linspace</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    t_profit <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> X_test[<span class="st">'decision'</span>]) <span class="op">*</span> (X_test[<span class="st">'paid_gain'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y_test) <span class="op">+</span> X_test[<span class="st">'default_loss'</span>] <span class="op">*</span> (y_test))    </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#calculating mean profit</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    all_total_profit.append(t_profit.mean())</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#return highest threshold based on highest gain</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> t_profit.mean() <span class="op">&gt;</span> best_profit:</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        best_profit <span class="op">=</span> t_profit.mean()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        best_t <span class="op">=</span> threshold[<span class="dv">0</span>] <span class="co">#threshold[0] with np.linspace</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        profit_per_borrower <span class="op">=</span> t_profit.mean()</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">#find probability and loop through thresholds</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_t_profit)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'highest profit: '</span>, best_profit)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'best threshold that optimizes profit for the bank: '</span>, best_t)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'bank’s expected profit per borrower: '</span>, profit_per_borrower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0       True
1       True
2       True
3       True
4       True
        ... 
6511    True
6513    True
6514    True
6515    True
6516    True
Name: decision, Length: 5731, dtype: bool
0        True
1        True
2       False
3        True
4       False
        ...  
6511     True
6513     True
6514     True
6515    False
6516     True
Name: decision, Length: 5731, dtype: bool
0       False
1        True
2       False
3       False
4       False
        ...  
6511    False
6513     True
6514     True
6515    False
6516    False
Name: decision, Length: 5731, dtype: bool
0       False
1       False
2       False
3       False
4       False
        ...  
6511    False
6513    False
6514    False
6515    False
6516    False
Name: decision, Length: 5731, dtype: bool
0       False
1       False
2       False
3       False
4       False
        ...  
6511    False
6513    False
6514    False
6515    False
6516    False
Name: decision, Length: 5731, dtype: bool
0       False
1       False
2       False
3       False
4       False
        ...  
6511    False
6513    False
6514    False
6515    False
6516    False
Name: decision, Length: 5731, dtype: bool
0
highest profit:  1168.3899694144973
best threshold that optimizes profit for the bank:  -0.17519863260740465
bank’s expected profit per borrower:  1168.3899694144973</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#threshold vs profit (all_total_profit)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(test_scores.<span class="bu">min</span>(), test_scores.<span class="bu">max</span>(), <span class="dv">100</span>), all_total_profit)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.gca().<span class="bu">set</span>(xlim<span class="op">=</span>(<span class="op">-</span><span class="dv">7</span>,<span class="va">None</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(x <span class="op">=</span> best_t, color <span class="op">=</span> <span class="st">'red'</span>, linestyle <span class="op">=</span> <span class="st">'--'</span>, lw <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Threshold"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Total Profit"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Threshold vs. Total Profit"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-f-evaluate-your-model-from-the-borrowers-perspective" class="level1">
<h1>Part F: Evaluate Your Model From the Borrower’s Perspective</h1>
<p>Is it more difficult for people in certain age groups to access credit under your proposed system?</p>
<div id="cell-34" class="cell" data-execution_count="304">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'age_cat'</span>] <span class="op">=</span> pd.cut(X_test[<span class="st">'person_age'</span>], <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">70</span>, <span class="dv">10</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>approval_rate_percent <span class="op">=</span> X_test.groupby(<span class="st">'age_cat'</span>)[<span class="st">'decision'</span>].mean() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">11</span>,<span class="dv">5</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>sns.barplot(X_test, x <span class="op">=</span> approval_rate_percent.index, y <span class="op">=</span> approval_rate_percent.values)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Age Group'</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Approval Rate Percent'</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#(X_test['person_age'], y_test)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/1j/mlsnh9t96n70j2n5mmm9h9780000gn/T/ipykernel_11168/2421308665.py:5: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  approval_rate_percent = X_test.groupby('age_cat')['decision'].mean() * 100
/Users/ddelgado/anaconda3/envs/ml-0451/lib/python3.9/site-packages/seaborn/categorical.py:641: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  grouped_vals = vals.groupby(grouper)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-24-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since, all of my decision column has the boolean true, they are all 0.0 floats. Therefore, no one age group has more difficulty in getting a loan in the proposed system.</p>
<p>Is it more difficult for people to get loans in order to pay for medical expenses? How does this compare with the actual rate of default in that group? What about people seeking loans for business ventures or education?</p>
<div id="cell-37" class="cell" data-execution_count="323">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>loan_intent_rate <span class="op">=</span> X_test.groupby([<span class="st">'loan_intent_EDUCATION'</span>, <span class="st">'loan_intent_MEDICAL'</span>, <span class="st">'loan_intent_VENTURE'</span>]).aggregate({<span class="st">'decision'</span> : <span class="st">'mean'</span>, <span class="st">'cb_person_default_on_file_N'</span> : <span class="st">'mean'</span>, <span class="st">'cb_person_default_on_file_Y'</span> : <span class="st">'mean'</span>})</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(loan_intent_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                               decision  \
loan_intent_EDUCATION loan_intent_MEDICAL loan_intent_VENTURE             
False                 False               False                     0.0   
                                          True                      0.0   
                      True                False                     0.0   
True                  False               False                     0.0   

                                                               cb_person_default_on_file_N  \
loan_intent_EDUCATION loan_intent_MEDICAL loan_intent_VENTURE                                
False                 False               False                                   0.809770   
                                          True                                    0.816390   
                      True                False                                   0.835974   
True                  False               False                                   0.816327   

                                                               cb_person_default_on_file_Y  
loan_intent_EDUCATION loan_intent_MEDICAL loan_intent_VENTURE                               
False                 False               False                                   0.190230  
                                          True                                    0.183610  
                      True                False                                   0.164026  
True                  False               False                                   0.183673  </code></pre>
</div>
</div>
<p>Since the decision column is all zeros, the comparison here is that the approval rate, or the decision, is less than the actual default rate for each education, medical and venture groups.</p>
<p>How does a person’s income level impact the ease with which they can access credit under your decision system?</p>
<div id="cell-40" class="cell" data-execution_count="338">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#income_groups = pd.cut(X_test['person_income'], range(4800,1782000, 10))</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>approval_rate_income <span class="op">=</span> X_test.groupby(pd.cut(X_test[<span class="st">'person_income'</span>], <span class="dv">25</span>))[<span class="st">'decision'</span>].mean()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(approval_rate_income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>person_income
(3022.8, 75888.0]         0.0
(75888.0, 146976.0]       0.0
(146976.0, 218064.0]      0.0
(218064.0, 289152.0]      0.0
(289152.0, 360240.0]      0.0
(360240.0, 431328.0]      0.0
(431328.0, 502416.0]      0.0
(502416.0, 573504.0]      0.0
(573504.0, 644592.0]      NaN
(644592.0, 715680.0]      0.0
(715680.0, 786768.0]      0.0
(786768.0, 857856.0]      0.0
(857856.0, 928944.0]      NaN
(928944.0, 1000032.0]     NaN
(1000032.0, 1071120.0]    NaN
(1071120.0, 1142208.0]    NaN
(1142208.0, 1213296.0]    0.0
(1213296.0, 1284384.0]    NaN
(1284384.0, 1355472.0]    NaN
(1355472.0, 1426560.0]    NaN
(1426560.0, 1497648.0]    NaN
(1497648.0, 1568736.0]    NaN
(1568736.0, 1639824.0]    NaN
(1639824.0, 1710912.0]    NaN
(1710912.0, 1782000.0]    0.0
Name: decision, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/1j/mlsnh9t96n70j2n5mmm9h9780000gn/T/ipykernel_11168/4155170202.py:3: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  approval_rate_income = X_test.groupby(pd.cut(X_test['person_income'], 25))['decision'].mean()</code></pre>
</div>
</div>
<p>A person’s income level does not impact the ease in which a person can access credit under the decision system as the decision says the mean is 0.0</p>
</section>
<section id="conclusion" class="level1">
<h1><strong>Conclusion</strong></h1>
<ul>
<li>In this blog post, what I learned was that something in my decisions might be calculated wrong or I might be missing something as all of my decisions say they are True for defaulting. If everything is correct, I learned that everyone is set to default on the loan, so there really is no difference between groups of people.</li>
</ul>
<p>Considering that people seeking loans for medical expense have high rates of default, is it fair that it is more difficult for them to obtain access to credit?</p>
<ul>
<li>Assuming my data showed that people seeking loans for medical expenses have higher rates of defaulting, I believe that it is fair for them to have more difficulty in obtaining access to credit. In this sense, it is fair because the bank has to think in terms of itself and if the people who seek medical expenses cannot pay the loan back, it is fair for the bank to deny their loan as it is money the bank will be losing. If something is fair, it does not mean it is morally correct. In this case, fairness is based on the system proposed and if a borrower falls into the given threshold for loan acceptance based on different factors. However, I would say it is not fair according to morals to deny the loan for their medical expenses as they need the money to get treatment/medication in order to remain alive.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>